import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="Product/Epics/Copilot V2+" />

# Epic: Copilot V2+ — Multi-turn, Streaming & Infrastructure

**Status:** Closed
**Closed on:** February 23, 2026
**Depends on:** [Copilot V1](?path=/docs/product-epics-copilot-v1--docs)

## Decision

This epic is closed — all seven work items shipped across frontend, backend, agents, infrastructure, and CI.

Engineering knowledge is now maintained in permanent documentation:

- [Engineering / Agents Service](?path=/docs/engineering-agents-service--docs) — conversation management, streaming protocol, read tools, model fallback
- [Product / Roadmap Projects](?path=/docs/product-roadmap-projects--docs) — V3 deferred items

## What shipped

- **Conversation history** — server-side DB persistence (`conversations` + `chat_messages` tables), last 50 messages included per request, frontend `conversationId` per session, clear/reset action
- **User items in prompt context** — `list_workspace_overview`, `read_item_content`, `list_project_items` read tools with delegated JWT scoping
- **Streaming (NDJSON)** — backend streams from agents, frontend `readNdjsonStream` parser, incremental rendering with `isStreaming` flag
- **Model fallback** — comma-separated `AGENT_MODEL` with retry, OpenTelemetry span attributes
- **K8s deployment** — `agents/Dockerfile`, `infra/k8s/base/agents.yaml`, production patches with resource limits
- **CI pipeline** — `agents-lint`, `agents-typecheck`, `agents-unit` jobs; all push jobs depend on agents CI
- **DB persistence** — conversation list with resume, archive, and new conversation actions; `ConversationList` component

## What moved to roadmap

Deferred to V3 and tracked in [Product / Roadmap Projects](?path=/docs/product-roadmap-projects--docs):

- Context window budget management (token counting, summarization)
- RAG/embedding strategy for large workspaces
- Conversation title generation (auto-summarize first message)
- Conversation search
