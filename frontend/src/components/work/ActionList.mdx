import { Meta } from "@storybook/addon-docs/blocks";

<Meta title="Work/ActionList" />

# ActionList

> **Status**: Implemented

Filtered list of next actions with context/energy/time filters per bucket.

Embodies **Principle 3: Gravity Creates Focus** â€” filters narrow by attraction,
never hiding context, and **Principle 8: Speed Over Ceremony** â€” instant filtering
with zero-friction interaction.

## Component Composition

```
ActionList
â”œâ”€â”€ ContextFilterBar      toggle buttons (checkbox role), multi-select
â”œâ”€â”€ EnergyFilterBar       radio button group, single-select with toggle-off
â”œâ”€â”€ TimeFilterDropdown    <select> dropdown for max time estimate
â””â”€â”€ ActionItem[]          filtered + sorted action cards
```

The `useActionFilters` hook manages all filter state, applies filters sequentially,
and handles sessionStorage persistence.

## Visual Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ·ï¸ @phone (4)  @computer (7)  @errands (2) [âœ•]â”‚  â† context filter chips
â”‚ âš¡ Energy: (Low) (Med) (High)                â”‚  â† energy radio group
â”‚ â±ï¸ Time: [Any â–¾]                              â”‚  â† time dropdown
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âš¡ Call insurance company    â˜…  @phone â”‚  â”‚  â† action item
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âš¡ Review contract draft     @computer â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âš¡ Buy stamps               @errands  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚
â”‚  12 actions Â· 3 focused                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Filter Behavior

Three independent filter dimensions combined with AND logic:

- **Context chips**: multi-select OR logic (show actions matching ANY selected context).
  Dynamically populated from available items, with per-context action counts.
  Clear button appears only when filters are active.
- **Energy**: single-select radio group (`low` / `medium` / `high`).
  Click selected level again to deselect. Filters by `computationPort.energyLevel`.
- **Time**: dropdown select (5 min, 15 min, 30 min, 1 hr, 2 hr, half-day).
  Shows actions with `computationPort.timeEstimate â‰¤ selected`. Items without a
  time estimate are excluded when this filter is active.

Filter bars render conditionally â€” only when contexts exist or filters are active.

## Persistence

Filter state is persisted to **sessionStorage** per bucket:

- **Key pattern**: `action-filters:{bucket}` (e.g. `action-filters:next`)
- **Stored shape**: `{ selectedContexts, selectedEnergy, maxTimeEstimate }`
- **Bucket-scoped**: each bucket maintains independent filter state; switching
  buckets saves current state and restores the target bucket's previous state.
- **Derived-state pattern**: state is loaded at render time (no `useEffect`),
  with silent fallback if sessionStorage is unavailable.

## Empty State

"No actions match your filters" with a "Clear filters" button that calls `clearAll()`.
