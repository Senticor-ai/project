@import "tailwindcss";
@import "material-symbols/outlined.css";

@custom-variant pointer-coarse (@media (pointer: coarse));
@custom-variant pointer-fine (@media (pointer: fine));

@theme {
  /* @tokens Paper (surfaces) */
  --color-paper-50: oklch(0.99 0.002 90);
  --color-paper-100: oklch(0.97 0.005 90);
  --color-paper-200: oklch(0.94 0.008 85);
  --color-paper-300: oklch(0.9 0.012 80);
  --color-paper-400: oklch(0.85 0.015 75);
  --color-paper-500: oklch(0.75 0.02 70);

  /* @tokens Blueprint (primary) */
  --color-blueprint-50: oklch(0.97 0.015 240);
  --color-blueprint-100: oklch(0.93 0.035 240);
  --color-blueprint-200: oklch(0.85 0.065 240);
  --color-blueprint-300: oklch(0.75 0.1 238);
  --color-blueprint-400: oklch(0.65 0.13 236);
  --color-blueprint-500: oklch(0.52 0.155 234);
  --color-blueprint-600: oklch(0.48 0.16 232);
  --color-blueprint-700: oklch(0.4 0.145 230);
  --color-blueprint-800: oklch(0.33 0.12 228);
  --color-blueprint-900: oklch(0.28 0.095 226);

  /* @tokens Industrial (accent) */
  --color-industrial-50: oklch(0.97 0.02 60);
  --color-industrial-100: oklch(0.93 0.05 55);
  --color-industrial-200: oklch(0.85 0.095 50);
  --color-industrial-300: oklch(0.75 0.14 45);
  --color-industrial-400: oklch(0.68 0.165 40);
  --color-industrial-500: oklch(0.6 0.18 35);
  --color-industrial-600: oklch(0.52 0.17 33);

  /* @tokens App Buckets (WCAG AA: ≥4.5:1 on /15 tint backgrounds) */
  --color-app-inbox: oklch(0.5 0.12 55);
  --color-app-next: oklch(0.45 0.15 145);
  --color-app-project: oklch(0.45 0.15 235);
  --color-app-waiting: oklch(0.47 0.1 300);
  --color-app-someday: oklch(0.48 0.08 210);
  --color-app-calendar: oklch(0.48 0.13 25);
  --color-app-reference: oklch(0.48 0.05 80);
  --color-app-focus: oklch(0.45 0.18 35);

  /* @tokens Confidence (WCAG AA: ≥4.5:1 on white) */
  --color-confidence-high: oklch(0.45 0.15 145);
  --color-confidence-medium: oklch(0.5 0.12 85);
  --color-confidence-low: oklch(0.48 0.15 25);
  --color-confidence-enrichment: oklch(0.5 0.12 55);

  /* @tokens Status (WCAG AA: ≥4.5:1 on white; use /10–/15 tint for backgrounds, /30–/40 for borders) */
  --color-status-error: oklch(0.55 0.2 25);
  --color-status-success: oklch(0.5 0.16 145);
  --color-status-warning: oklch(0.52 0.14 55);
  --color-status-info: var(--color-blueprint-500);

  /* @tokens Semantic colors */
  --color-surface: var(--color-paper-50);
  --color-surface-raised: var(--color-paper-100);
  --color-surface-overlay: var(--color-paper-200);
  --color-border: var(--color-paper-300);
  --color-border-strong: var(--color-paper-400);
  --color-text: oklch(0.25 0.01 260);
  --color-text-muted: oklch(0.4 0.01 260);
  --color-text-subtle: oklch(0.43 0.008 260);
  --color-primary: var(--color-blueprint-600);
  --color-primary-hover: var(--color-blueprint-700);
  --color-accent: var(--color-industrial-500);
  --color-accent-hover: var(--color-industrial-600);

  /* @tokens Typography */
  --font-sans: "Inter", "system-ui", sans-serif;
  --font-mono: "JetBrains Mono", "Fira Code", monospace;

  /* @tokens Elevation */
  --shadow-card:
    0 1px 3px oklch(0.2 0 0 / 0.08), 0 1px 2px oklch(0.2 0 0 / 0.06);
  --shadow-card-hover:
    0 4px 12px oklch(0.2 0 0 / 0.1), 0 2px 4px oklch(0.2 0 0 / 0.06);
  --shadow-sheet: 0 8px 30px oklch(0.2 0 0 / 0.12);
  --shadow-overlay: 0 12px 40px oklch(0.2 0 0 / 0.15);

  /* @tokens Radius */
  --radius-sm: 0.25rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;

  /* @tokens Motion */
  --duration-instant: 100ms;
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --duration-slow: 400ms;
  --ease-snap: cubic-bezier(0.2, 0.8, 0.2, 1);
  --ease-unfold: cubic-bezier(0.4, 0, 0.2, 1);
}

/* Safe-area inset utilities for notched/rounded-corner devices */
@utility pb-safe {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}
@utility pr-safe {
  padding-right: env(safe-area-inset-right, 0px);
}
@utility pl-safe {
  padding-left: env(safe-area-inset-left, 0px);
}
@utility pt-safe {
  padding-top: env(safe-area-inset-top, 0px);
}

/* Copilot chat bubble prose — compact markdown styling */
.copilot-prose > :first-child {
  margin-top: 0;
}
.copilot-prose > :last-child {
  margin-bottom: 0;
}
.copilot-prose p {
  margin: 0.25em 0;
}
.copilot-prose strong {
  font-weight: 600;
}
.copilot-prose ol {
  margin: 0.25em 0;
  padding-left: 1.25em;
  list-style-type: decimal;
}
.copilot-prose ul {
  margin: 0.25em 0;
  padding-left: 1.25em;
  list-style-type: disc;
}
.copilot-prose li {
  margin: 0.15em 0;
}
.copilot-prose li > p {
  margin: 0;
}
.copilot-prose code {
  font-size: 0.85em;
  background-color: var(--color-paper-100);
  padding: 0.1em 0.3em;
  border-radius: 0.25rem;
}
.copilot-prose pre {
  margin: 0.5em 0;
  padding: 0.5em 0.75em;
  background-color: var(--color-paper-100);
  border-radius: 0.375rem;
  overflow-x: auto;
}
.copilot-prose pre code {
  background: none;
  padding: 0;
}
.copilot-prose a {
  color: var(--color-blueprint-600);
  text-decoration: underline;
}
.copilot-prose blockquote {
  margin: 0.5em 0;
  padding-left: 0.75em;
  border-left: 2px solid var(--color-paper-300);
  color: var(--color-text-muted);
}

/* Markdown prose — richer styling for reference/document views */
.markdown-prose > :first-child {
  margin-top: 0;
}
.markdown-prose > :last-child {
  margin-bottom: 0;
}
.markdown-prose h1 {
  font-size: 1.5em;
  font-weight: 700;
  margin: 0.75em 0 0.4em;
}
.markdown-prose h2 {
  font-size: 1.25em;
  font-weight: 600;
  margin: 0.6em 0 0.3em;
}
.markdown-prose h3 {
  font-size: 1.1em;
  font-weight: 600;
  margin: 0.5em 0 0.25em;
}
.markdown-prose p {
  margin: 0.4em 0;
}
.markdown-prose strong {
  font-weight: 700;
}
.markdown-prose ol {
  margin: 0.4em 0;
  padding-left: 1.5em;
  list-style-type: decimal;
}
.markdown-prose ul {
  margin: 0.4em 0;
  padding-left: 1.5em;
  list-style-type: disc;
}
.markdown-prose li {
  margin: 0.2em 0;
}
.markdown-prose li > p {
  margin: 0;
}
.markdown-prose code {
  font-size: 0.85em;
  background-color: var(--color-paper-100);
  padding: 0.1em 0.3em;
  border-radius: 0.25rem;
}
.markdown-prose pre {
  margin: 0.5em 0;
  padding: 0.75em 1em;
  background-color: var(--color-paper-100);
  border-radius: 0.375rem;
  overflow-x: auto;
}
.markdown-prose pre code {
  background: none;
  padding: 0;
}
.markdown-prose a {
  color: var(--color-blueprint-600);
  text-decoration: underline;
}
.markdown-prose blockquote {
  margin: 0.5em 0;
  padding-left: 0.75em;
  border-left: 3px solid var(--color-paper-300);
  color: var(--color-text-muted);
}
.markdown-prose table {
  width: 100%;
  border-collapse: collapse;
  margin: 0.5em 0;
}
.markdown-prose th,
.markdown-prose td {
  border: 1px solid var(--color-paper-200);
  padding: 0.35em 0.6em;
  text-align: left;
}
.markdown-prose th {
  font-weight: 600;
  background-color: var(--color-paper-50);
}
.markdown-prose hr {
  border: none;
  border-top: 1px solid var(--color-paper-200);
  margin: 1em 0;
}

/* Base reset */
body {
  margin: 0;
  font-family: var(--font-sans);
  background-color: var(--color-surface);
  color: var(--color-text);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ─── SlideShow presenter mode (enabled by ?full=1) ─── */
[data-slideshow-mode="present"] {
  min-height: 100vh;
  padding: 1rem 1rem 5rem;
  background: #f8fafc;
}

[data-slideshow-mode="present"] [data-slide] {
  display: none;
  margin: 0;
  min-height: calc(100vh - 6.25rem);
  max-height: calc(100vh - 6.25rem);
  overflow: auto;
}

[data-slideshow-mode="present"] [data-slide][data-slide-active="true"] {
  display: block;
}

/* In presenter mode, keep slides visual-first by hiding narrative body text. */
[data-slideshow-mode="present"] [data-slide-notes] {
  display: none !important;
}

[data-slideshow-mode="present"]
  [data-slide][data-slide-has-visual="true"]
  [data-slide-body]
  > :where(h1, h2, h3, h4, h5, h6, p, ul, ol, blockquote, hr) {
  display: none;
}

[data-slideshow-mode="present"]
  [data-slide][data-slide-has-visual="true"]
  [data-slide-body]
  > :where(table, pre, figure, img, svg, [data-slide-visual]) {
  margin: 0 auto;
}

[data-slideshow-mode="present"] [data-slide-body] table {
  font-size: 0.96rem;
}

[data-slideshow-mode="present"] [data-slide-body] pre {
  font-size: 0.9rem;
  overflow: auto;
}

/* ─── Print / PDF (triggered by SlideShow's ⎙ pdf button or browser Cmd+P) ─── */
@media print {
  @page {
    size: A4;
    margin: 2cm 2.5cm;
  }

  /* Hide the floating slide navigation overlay */
  [data-slideshow-nav] {
    display: none !important;
  }

  /* Clean slide cards: no shadow, keep border + accent */
  [data-slide] {
    box-shadow: none !important;
    border: 1px solid #d1d5db !important;
    border-left: 4px solid #1a6fa0 !important;
    break-inside: avoid;
    page-break-inside: avoid;
  }

  /* Optional: force a new page before slides marked with breakBefore */
  [data-slide-break="before"] {
    break-before: page;
    page-break-before: always;
  }

  /* Mermaid / inline SVG: scale to fit the page width */
  svg {
    max-width: 100% !important;
    height: auto !important;
  }

  /* Keep links visible as text — they won't be clickable in PDF */
  a[href]::after {
    content: none;
  }
}
