# Project prefix — drives Docker Compose Senticor Project name, database names, volume names.
# Short lowercase identifier unique to this Senticor Project.
PROJECT_PREFIX=project

# Port offset — set a unique value per checkout to avoid port collisions
# when multiple checkouts run on the same machine (e.g. human + Claude + Codex).
# Checkout A: PORT_OFFSET=0 (default), Checkout B: PORT_OFFSET=100, etc.
# All service ports shift by this value. See scripts/ports.sh for the full map.
PORT_OFFSET=0

# REQUIRED - generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# Used for internal tokens (e.g. Google Drive OAuth state, delegated JWT signing)
JWT_SECRET=<generate-with-python-secrets>

# Delegated JWT for agent On-Behalf-Of flows (RFC 8693 semantics)
# Falls back to JWT_SECRET if not set. Use a separate secret in production.
# DELEGATION_JWT_SECRET=<generate-with-python-secrets>
DELEGATION_JWT_TTL_SECONDS=60

# Agents service (Copilot agent) — optional, app works without it
AGENTS_URL=http://localhost:8002
AGENTS_PORT=8002
AGENT_REQUIRE_USER_API_KEY=false

OPENROUTER_API_KEY=<your-openrouter-api-key>
OPENROUTER_APP_URL=http://localhost:5173
OPENROUTER_APP_TITLE="Senticor Project"
OPENROUTER_MODEL=qwen/qwen3-next-80b-a3b-instruct:free,nvidia/nemotron-3-nano-30b-a3b:free,tngtech/tng-r1t-chimera:free
AGENT_MODEL=qwen/qwen3-next-80b-a3b-instruct:free,nvidia/nemotron-3-nano-30b-a3b:free,tngtech/tng-r1t-chimera:free
LLM_CACHE_DIR=output/cache/llm
EMBEDDING_CACHE_DIR=output/cache/embeddings

# Optional external web tools for Copilot (read-only)
SEARCHAPI_API_KEY=
SEARCHAPI_ENDPOINT=https://www.searchapi.io/api/v1/search
SEARCHAPI_TIMEOUT_SECONDS=12
# Allowlist rules for `web_fetch` (comma-separated domains and/or URL prefixes).
# Examples:
# COPILOT_WEBFETCH_ALLOWLIST=docs.example.com,help.example.com
# COPILOT_WEBFETCH_ALLOWLIST=*.bund.de
# COPILOT_WEBFETCH_ALLOWLIST=https://docs.example.com/shared
COPILOT_WEBFETCH_ALLOWLIST=*.bund.de
COPILOT_WEBFETCH_TIMEOUT_SECONDS=12
COPILOT_WEBFETCH_MAX_CHARS=12000

# PostgreSQL
# DB name convention: ${PROJECT_PREFIX} for dev, ${PROJECT_PREFIX}_e2e for E2E tests
POSTGRES_PASSWORD=<your-postgres-password>
POSTGRES_USER=<your-postgres-user>
POSTGRES_DB=project
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
DATABASE_URL=postgresql://<user>:<password>@localhost:5432/project

# API + CORS
VITE_API_BASE_URL=http://localhost:8000
CORS_ORIGINS=http://localhost:5173,http://localhost:6006

# Session auth (local)
SESSION_COOKIE_NAME=project_session
SESSION_TTL_DAYS=30
SESSION_TTL_MINUTES=
SESSION_TTL_SECONDS=
SESSION_REFRESH_TTL_DAYS=30
SESSION_REFRESH_COOKIE_NAME=project_refresh
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_SAMESITE=lax
SESSION_COOKIE_DOMAIN=
SESSION_COOKIE_PATH=/
SESSION_COOKIE_HTTP_ONLY=true
SESSION_BIND_IP=true
SESSION_BIND_USER_AGENT=true
SESSION_ROLL_IP_ON_REFRESH=true
SESSION_ROLL_UA_ON_REFRESH=true
TRUST_PROXY_HEADERS=false

# CSRF (BFF)
CSRF_ENABLED=false
CSRF_COOKIE_NAME=project_csrf
CSRF_HEADER_NAME=X-CSRF-Token
CSRF_COOKIE_SECURE=false
CSRF_COOKIE_SAMESITE=lax
CSRF_COOKIE_DOMAIN=
CSRF_COOKIE_PATH=/

# WeasyPrint (PDF rendering) — macOS only
# brew install pango cairo gdk-pixbuf
# The dynamic linker needs this to find Homebrew-installed C libraries.
# Not needed in Docker (system packages installed in Dockerfile).
DYLD_FALLBACK_LIBRARY_PATH=/opt/homebrew/lib

# File storage (local dev)
FILE_STORAGE_PATH=storage
UPLOAD_CHUNK_SIZE=5242880
IMPORT_JOB_QUEUE_TIMEOUT_SECONDS=300
OUTBOX_WORKER_POLL_SECONDS=1.0
OUTBOX_WORKER_LISTEN_NOTIFY=true
OUTBOX_WORKER_NOTIFY_FALLBACK_SECONDS=30.0
OUTBOX_NOTIFY_CHANNEL=outbox_events
PUSH_WORKER_POLL_SECONDS=1.0
WORKER_HEALTH_PORT=9090
PUSH_WORKER_HEALTH_PORT=9091
WORKER_HEALTH_STALENESS_MULTIPLIER=3.0

# Web Push (VAPID) — generate keys with: npx web-push generate-vapid-keys
VAPID_PUBLIC_KEY=<your-vapid-public-key>
VAPID_PRIVATE_KEY=<your-vapid-private-key>
VAPID_SUBJECT=mailto:admin@example.com

# Developer tools (dangerous; disables /dev/* endpoints when false)
DEV_TOOLS_ENABLED=false

# Observability
LOG_FORMAT=json
# Optional salt for deterministic anonymized user identifiers in logs.
# Falls back to JWT_SECRET when unset.
LOG_ANONYMIZATION_SALT=<optional-log-anonymization-salt>

# Grafana Faro (frontend observability — optional)
# Collector URL from your Grafana Cloud or self-hosted Faro instance.
# Leave empty to disable Faro instrumentation.
VITE_FARO_COLLECTOR_URL=<your-faro-collector-url>
VITE_FARO_APP_NAME=${PROJECT_PREFIX}
VITE_FARO_ENVIRONMENT=development

# Gmail OAuth (optional — enables email ingestion via Gmail API)
# See Storybook > Engineering > Email Integration for full setup instructions.
# Create OAuth 2.0 credentials at https://console.cloud.google.com/apis/credentials
GMAIL_CLIENT_ID=<your-google-oauth-client-id>
GMAIL_CLIENT_SECRET=<your-google-oauth-client-secret>
GMAIL_REDIRECT_URI=http://localhost:8000/email/oauth/gmail/callback
GMAIL_STATE_SECRET=<generate-with-python-secrets>

# Gmail Watch + Pub/Sub (enables real-time email sync via Pub/Sub pull)
# Watch mode auto-enables when the required Pub/Sub variables below are set.
GMAIL_PUBSUB_PROJECT_ID=<your-gcp-project-id>
GMAIL_PUBSUB_TOPIC=gmail-notifications
GMAIL_PUBSUB_SUBSCRIPTION=gmail-notifications-pull
GMAIL_PUBSUB_CREDENTIALS_FILE=<path-to-service-account-json>

# OpenClaw (alternative agent backend — optional)
# When configured, users can switch to OpenClaw in Agent Setup settings.
# Shared dev instance URL (Phase 2 adds per-user containers).
# OPENCLAW_URL=http://localhost:18789
# OPENCLAW_GATEWAY_TOKEN=<your-openclaw-gateway-token>

# Per-user container management (Phase 2)
# OPENCLAW_IMAGE=ghcr.io/openclaw-ai/openclaw:latest
# OPENCLAW_PORT_RANGE_START=18800
# OPENCLAW_PORT_RANGE_END=18899
# OPENCLAW_IDLE_TIMEOUT_SECONDS=1800
# OPENCLAW_HEALTH_CHECK_TIMEOUT=15

# Token encryption (Fernet key for OAuth tokens at rest)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=<generate-fernet-key>

# Frontend URL (used for OAuth callback redirect to frontend)
FRONTEND_BASE_URL=http://localhost:5173

# E2E Testing
# Copy to .env.e2e and adjust. See scripts/e2e-stack.sh.
# Uses separate database (${PROJECT_PREFIX}_e2e), separate cookie names, and
# dedicated ports computed from PORT_OFFSET (see scripts/ports.sh).
